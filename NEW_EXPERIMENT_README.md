# æ–°éŸ³æ¨‚å¯¦é©—ç³»çµ±ä½¿ç”¨èªªæ˜

## ğŸ“‹ ç³»çµ±æ¦‚è¿°

é€™æ˜¯ä¸€å€‹å…¨æ–°è¨­è¨ˆçš„éŸ³æ¨‚å¯¦é©—ç³»çµ±ï¼Œç”¨æ–¼è©•ä¼°ä¸åŒéŸ³æ¨‚é¡åˆ¥å°å—æ¸¬è€…çš„å¿ƒç†å’Œç”Ÿç†å½±éŸ¿ã€‚

### **å¯¦é©—è¨­è¨ˆ**
- **å—æ¸¬è€…æ•¸é‡**ï¼š30äºº
- **å¯¦é©—æ¬¡æ•¸**ï¼šæ¯äºº6æ¬¡ï¼ˆæ¯æ¬¡ä¸€å€‹éŸ³æ¨‚é¡åˆ¥ï¼‰
- **éŸ³æ¨‚é¡åˆ¥**ï¼š6ç¨®ï¼ˆNature, Ambient, New-Age, Instrumental, Lo-fi, Therapeuticï¼‰
- **æ¯æ¬¡æ™‚é•·**ï¼šç´„15-20åˆ†é˜
- **çµ„åˆ¥è¨­è¨ˆ**ï¼šAçµ„/Bçµ„ï¼ˆå¹³è¡¡æ­Œæ›²æ’­æ”¾é †åºï¼‰

---

## ğŸš€ å¿«é€Ÿé–‹å§‹

### **å•Ÿå‹•ç¨‹å¼**

```bash
# é™¤éŒ¯æ¨¡å¼ï¼ˆå¯å¿«é€Ÿè·³éå„éšæ®µï¼‰
python3 new_experiment.py

# ä¿®æ”¹ new_experiment.py ä¸­çš„ DEBUG_MODE = False é€²å…¥æ­£å¼æ¨¡å¼
```

### **å¯¦é©—æµç¨‹**

```
é–‹å§‹é é¢ï¼ˆè¨­å®šåƒæ•¸ï¼‰
  â†“
Baseline (3åˆ†é˜)
  â†“
éŸ³æ¨‚1 (5åˆ†é˜)
  â†“
å•å·1 (3é¡Œ)
  â†“
é–“éš”ä¼‘æ¯1 (è‡³å°‘3åˆ†é˜)
  â†“
éŸ³æ¨‚2 (5åˆ†é˜)
  â†“
å•å·2 (3é¡Œ)
  â†“
é–“éš”ä¼‘æ¯2 (è‡³å°‘3åˆ†é˜)
  â†“
å®Œæˆ
```

---

## ğŸ“‚ æª”æ¡ˆçµæ§‹

### **æ–°å¢æª”æ¡ˆ**

```
ARMO_EQ_exp1/
â”œâ”€â”€ new_experiment.py                 # æ–°å¯¦é©—å•Ÿå‹•æª”æ¡ˆ â­
â”œâ”€â”€ music_catalog.json                # éŸ³æ¨‚ç›®éŒ„é…ç½® â­
â”œâ”€â”€ NEW_EXPERIMENT_README.md          # æœ¬èªªæ˜æ–‡ä»¶ â­
â”‚
â”œâ”€â”€ ui/
â”‚   â”œâ”€â”€ NewExperimentWindow.py        # æ–°å¯¦é©—ä¸»æ§åˆ¶å™¨ â­
â”‚   â”œâ”€â”€ EventLogger.py                # æ™‚é–“æˆ³è¨˜éŒ„æœå‹™ â­
â”‚   â”œâ”€â”€ BaselinePage.py               # Baselineé é¢ â­
â”‚   â”œâ”€â”€ MusicPageWithTimer.py         # éŸ³æ¨‚æ’­æ”¾é é¢ï¼ˆå«å€’æ•¸ï¼‰ â­
â”‚   â”œâ”€â”€ IntervalPage.py               # é–“éš”ä¼‘æ¯é é¢ â­
â”‚   â”‚
â”‚   â””â”€â”€ json/new_experiment/          # æ–°å¯¦é©—å•å· â­
â”‚       â””â”€â”€ music_evaluation_new.json
â”‚
â”œâ”€â”€ music/                            # éŸ³æ¨‚æª”æ¡ˆç›®éŒ„
â”‚   â”œâ”€â”€ Nature/
â”‚   â”‚   â”œâ”€â”€ NA001.wav
â”‚   â”‚   â””â”€â”€ NA002.wav
â”‚   â”œâ”€â”€ Ambient/
â”‚   â”‚   â”œâ”€â”€ AM001.wav
â”‚   â”‚   â””â”€â”€ AM002.wav
â”‚   â”œâ”€â”€ New-Age/
â”‚   â”‚   â”œâ”€â”€ NEA001.wav
â”‚   â”‚   â””â”€â”€ NEA002.wav
â”‚   â”œâ”€â”€ Instrumental/
â”‚   â”‚   â”œâ”€â”€ IN001.wav
â”‚   â”‚   â””â”€â”€ IN002.wav
â”‚   â”œâ”€â”€ Lo-fi/
â”‚   â”‚   â”œâ”€â”€ LO001.wav
â”‚   â”‚   â””â”€â”€ LO002.wav
â”‚   â””â”€â”€ Therapeutic/
â”‚       â”œâ”€â”€ TH001.wav
â”‚       â””â”€â”€ TH002.wav
â”‚
â””â”€â”€ test_result/                      # å¯¦é©—çµæœ
    â””â”€â”€ P001_S1_GA_20231115_143022/   # ç¯„ä¾‹çµæœç›®éŒ„
        â”œâ”€â”€ experiment_info.json      # å¯¦é©—åƒæ•¸
        â”œâ”€â”€ event_log.csv             # æ™‚é–“æˆ³è¨˜éŒ„ â­
        â”œâ”€â”€ music1_evaluation_*.csv   # éŸ³æ¨‚1å•å·
        â””â”€â”€ music2_evaluation_*.csv   # éŸ³æ¨‚2å•å·
```

---

## âš™ï¸ å¯¦é©—åƒæ•¸èªªæ˜

### **é–‹å§‹é é¢è¨­å®š**

| åƒæ•¸ | é¸é … | èªªæ˜ |
|------|------|------|
| **å—æ¸¬è€…ç·¨è™Ÿ** | 1-30 | ç”¨æ–¼è­˜åˆ¥å—æ¸¬è€… |
| **ç¬¬å¹¾æ¬¡ä¾†** | 1-6 | è¨˜éŒ„é€™æ˜¯ç¬¬å¹¾æ¬¡å¯¦é©— |
| **éŸ³æ¨‚é¡åˆ¥** | Nature/Ambient/New-Age/Instrumental/Lo-fi/Therapeutic | æœ¬æ¬¡å¯¦é©—çš„éŸ³æ¨‚é¡åˆ¥ |
| **çµ„åˆ¥** | Açµ„/Bçµ„ | Açµ„ï¼š001â†’002ï¼ŒBçµ„ï¼š002â†’001 |

### **çµ„åˆ¥è¨­è¨ˆèªªæ˜**

- **Açµ„**ï¼šå…ˆæ’­æ”¾ 001ï¼Œå¾Œæ’­æ”¾ 002
- **Bçµ„**ï¼šå…ˆæ’­æ”¾ 002ï¼Œå¾Œæ’­æ”¾ 001
- **ç›®çš„**ï¼šå¹³è¡¡æ­Œæ›²é †åºæ•ˆæ‡‰ï¼Œç¢ºä¿æ¯é¦–æ­Œåœ¨å…©å€‹ä½ç½®éƒ½æœ‰ç›¸åŒæ•¸é‡çš„è³‡æ–™

---

## ğŸ“Š è¼¸å‡ºè³‡æ–™èªªæ˜

### **1. experiment_info.json**

è¨˜éŒ„å¯¦é©—åƒæ•¸ï¼š

```json
{
  "subject_id": 1,
  "session_number": 1,
  "group": "A",
  "category": "Nature",
  "category_code": "NA",
  "song_order": ["001", "002"],
  "music_files": ["NA001.wav", "NA002.wav"],
  "start_time": "2023-11-15 14:30:22",
  "debug_mode": false
}
```

### **2. event_log.csv** â­ é‡è¦

è¨˜éŒ„æ¯å€‹éšæ®µçš„ç²¾ç¢ºæ™‚é–“æˆ³ï¼ˆæ¯«ç§’ç´šï¼‰ï¼š

```csv
timestamp,event_type,phase,music_id,notes
2023-11-15 14:30:22.123,phase_start,baseline,,
2023-11-15 14:33:22.123,phase_end,baseline,,
2023-11-15 14:33:22.124,phase_start,music1,NA001,
2023-11-15 14:38:22.124,phase_end,music1,NA001,
...
```

**éšæ®µæ¨™ç±¤**ï¼š
- `baseline` - Baselineéšæ®µ
- `music1` / `music2` - éŸ³æ¨‚æ’­æ”¾
- `questionnaire1` / `questionnaire2` - å•å·å¡«å¯«
- `interval1` / `interval2` - é–“éš”ä¼‘æ¯
- `complete` - å¯¦é©—å®Œæˆ

### **3. å•å·çµæœ CSV**

```csv
question_id,question,dimension,answer,score,timestamp
q1,ä½ ç¾åœ¨çš„å¿ƒæƒ…æ„Ÿè¦ºæ€éº¼æ¨£ï¼Ÿ,valence,æœ‰é»æ„‰å¿«,4,20231115_143822
q2,ä½ ç¾åœ¨çš„ç²¾ç¥æ„Ÿè¦ºæ€éº¼æ¨£ï¼Ÿ,arousal,æ™®é€š,3,20231115_143822
q3,ä½ è¦ºå¾—é€™é¦–æ­Œæ›²çš„æ”¾é¬†ç¨‹åº¦,relaxation,æœ‰é»æ”¾é¬†,4,20231115_143822
```

---

## ğŸµ éŸ³æ¨‚æª”æ¡ˆæº–å‚™

### **æª”æ¡ˆå‘½åè¦å‰‡**

| é¡åˆ¥ | ä»£ç¢¼ | æª”æ¡ˆåç¨±ç¯„ä¾‹ |
|------|------|-------------|
| Nature | NA | NA001.wav, NA002.wav |
| Ambient | AM | AM001.wav, AM002.wav |
| New-Age | NEA | NEA001.wav, NEA002.wav |
| Instrumental | IN | IN001.wav, IN002.wav |
| Lo-fi | LO | LO001.wav, LO002.wav |
| Therapeutic | TH | TH001.wav, TH002.wav |

### **ç›®éŒ„çµæ§‹**

```
music/
  â”œâ”€â”€ Nature/
  â”‚   â”œâ”€â”€ NA001.wav
  â”‚   â””â”€â”€ NA002.wav
  â”œâ”€â”€ Ambient/
  â”‚   â”œâ”€â”€ AM001.wav
  â”‚   â””â”€â”€ AM002.wav
  ... (å…¶ä»–é¡åˆ¥)
```

### **æª”æ¡ˆæ ¼å¼**
- **æ ¼å¼**ï¼šWAVï¼ˆå„ªå…ˆï¼‰
- **å»ºè­°**ï¼š16-bit, 44.1kHz æˆ–æ›´é«˜
- **é•·åº¦**ï¼šè‡³å°‘5åˆ†é˜

---

## ğŸ› é™¤éŒ¯æ¨¡å¼

### **å•Ÿç”¨æ–¹å¼**

ä¿®æ”¹ `new_experiment.py` ä¸­çš„ï¼š
```python
DEBUG_MODE = True  # é™¤éŒ¯æ¨¡å¼
```

### **é™¤éŒ¯æ¨¡å¼åŠŸèƒ½**

- âœ… **Baselineé é¢**ï¼šé¡¯ç¤ºã€Œè·³éã€æŒ‰éˆ•
- âœ… **éŸ³æ¨‚æ’­æ”¾**ï¼šé¡¯ç¤ºã€Œè·³éã€æŒ‰éˆ•
- âœ… **é–“éš”ä¼‘æ¯**ï¼šç«‹å³å•Ÿç”¨ã€Œç¹¼çºŒã€æŒ‰éˆ•ï¼ˆç„¡éœ€ç­‰å¾…3åˆ†é˜ï¼‰
- âœ… **è¦–çª—æ¨™é¡Œ**ï¼šé¡¯ç¤º `[é™¤éŒ¯æ¨¡å¼]` æ¨™è¨˜

### **æ­£å¼æ¨¡å¼**

```python
DEBUG_MODE = False  # æ­£å¼æ¨¡å¼
```

- â± Baselineï¼šå¿…é ˆç­‰å¾…3åˆ†é˜
- â± éŸ³æ¨‚æ’­æ”¾ï¼šå¿…é ˆæ’­æ”¾å®Œ5åˆ†é˜
- â± é–“éš”ä¼‘æ¯ï¼šè‡³å°‘3åˆ†é˜å¾Œæ‰èƒ½é»æ“Šç¹¼çºŒ

---

## ğŸ”§ å•å·å…§å®¹

### **éŸ³æ¨‚è©•ä¼°å•å·ï¼ˆ3é¡Œï¼‰**

1. **ä½ ç¾åœ¨çš„å¿ƒæƒ…æ„Ÿè¦ºæ€éº¼æ¨£ï¼Ÿ** (valence)
   - é¸é …ï¼šéå¸¸ä¸å¥½ / æœ‰é»ä¸å¥½ / æ™®é€š / æœ‰é»æ„‰å¿« / éå¸¸æ„‰å¿«

2. **ä½ ç¾åœ¨çš„ç²¾ç¥æ„Ÿè¦ºæ€éº¼æ¨£ï¼Ÿ** (arousal)
   - é¸é …ï¼šéå¸¸å¹³éœ / æœ‰é»æ”¾é¬† / æ™®é€š / æœ‰é»ç·Šç¹ƒ / éå¸¸äº¢å¥®

3. **ä½ è¦ºå¾—é€™é¦–æ­Œæ›²çš„æ”¾é¬†ç¨‹åº¦** (relaxation)
   - é¸é …ï¼šéå¸¸ç·Šç¹ƒ / æœ‰é»ç·Šç¹ƒ / æ™®é€š / æœ‰é»æ”¾é¬† / éå¸¸æ”¾é¬†

### **ä¿®æ”¹å•å·**

ç·¨è¼¯æª”æ¡ˆï¼š`ui/json/new_experiment/music_evaluation_new.json`

---

## ğŸ“ˆ è³‡æ–™åˆ†æ

### **æ™‚é–“æˆ³åˆ†æ**

`event_log.csv` å¯ç”¨æ–¼ï¼š
- åŒæ­¥ç”Ÿç†è³‡æ–™ï¼ˆå¦‚EEGã€å¿ƒç‡ï¼‰
- åˆ†æå„éšæ®µç¢ºåˆ‡æ™‚é•·
- é©—è­‰å¯¦é©—æµç¨‹æ˜¯å¦æ­£ç¢ºåŸ·è¡Œ

### **ç¯„ä¾‹åˆ†æä»£ç¢¼**

```python
import pandas as pd

# è¼‰å…¥æ™‚é–“æˆ³è¨˜éŒ„
df = pd.read_csv('test_result/P001_S1_GA_*/event_log.csv')

# è¨ˆç®—éŸ³æ¨‚1çš„å¯¦éš›æ’­æ”¾æ™‚é•·
music1_start = df[(df['phase']=='music1') & (df['event_type']=='phase_start')]['timestamp'].iloc[0]
music1_end = df[(df['phase']=='music1') & (df['event_type']=='phase_end')]['timestamp'].iloc[0]

# è½‰æ›ç‚ºdatetimeä¸¦è¨ˆç®—æ™‚é•·
from datetime import datetime
start_time = datetime.strptime(music1_start, "%Y-%m-%d %H:%M:%S.%f")
end_time = datetime.strptime(music1_end, "%Y-%m-%d %H:%M:%S.%f")
duration = (end_time - start_time).total_seconds()
print(f"éŸ³æ¨‚1æ’­æ”¾æ™‚é•·: {duration} ç§’")
```

---

## â“ å¸¸è¦‹å•é¡Œ

### **Q: å¦‚ä½•æ¸¬è©¦ç³»çµ±ï¼Ÿ**
A: é–‹å•Ÿé™¤éŒ¯æ¨¡å¼ï¼ˆDEBUG_MODE = Trueï¼‰ï¼Œå¯å¿«é€Ÿæ¸¬è©¦å®Œæ•´æµç¨‹ã€‚

### **Q: éŸ³æª”æ‰¾ä¸åˆ°æ€éº¼è¾¦ï¼Ÿ**
A:
1. ç¢ºèªæª”æ¡ˆå‘½åæ­£ç¢ºï¼ˆå¦‚ NA001.wavï¼‰
2. ç¢ºèªæª”æ¡ˆæ”¾åœ¨æ­£ç¢ºç›®éŒ„ï¼ˆå¦‚ music/Nature/NA001.wavï¼‰
3. æª¢æŸ¥æª”æ¡ˆæ ¼å¼ç‚º .wav

### **Q: å¦‚ä½•ä¿®æ”¹æ™‚é–“è¨­å®šï¼Ÿ**
A: ç·¨è¼¯ `ui/NewExperimentWindow.py` ä¸­çš„ `ExperimentConfig` é¡åˆ¥ï¼š
```python
class ExperimentConfig:
    BASELINE_DURATION = 180      # 3åˆ†é˜ â†’ å¯ä¿®æ”¹
    MUSIC_DURATION = 300         # 5åˆ†é˜ â†’ å¯ä¿®æ”¹
    INTERVAL_MIN_DURATION = 180  # è‡³å°‘3åˆ†é˜ â†’ å¯ä¿®æ”¹
```

### **Q: å¦‚ä½•åŒ¯å‡ºç”Ÿç†è³‡æ–™æ™‚é–“å°æ‡‰ï¼Ÿ**
A: ä½¿ç”¨ `event_log.csv` ä¸­çš„æ™‚é–“æˆ³èˆ‡ç”Ÿç†è¨Šè™Ÿè¨˜éŒ„é€²è¡Œå°é½Šã€‚

---

## ğŸ”„ èˆ‡èˆŠç³»çµ±çš„å·®ç•°

| é …ç›® | èˆŠç³»çµ± (armo_eq.py) | æ–°ç³»çµ± (new_experiment.py) |
|------|---------------------|---------------------------|
| **éŸ³æ¨‚é¡å‹** | å¤å…¸/æµè¡Œ/çˆµå£« | Nature/Ambient/New-Age/Instrumental/Lo-fi/Therapeutic |
| **å¯¦é©—è¨­è¨ˆ** | EQ vs. åŸå§‹éŸ³æ¨‚ | Açµ„ vs. Bçµ„ï¼ˆæ­Œæ›²é †åºï¼‰ |
| **æ¯è¼ªæ­Œæ›²æ•¸** | 2é¦–ï¼ˆEQ + åŸå§‹ï¼‰ | 2é¦–ï¼ˆ001 + 002ï¼‰ |
| **æ™‚é–“è¨˜éŒ„** | ç„¡ | event_log.csv ç²¾ç¢ºè¨˜éŒ„ â­ |
| **Baseline** | ç„¡ | 3åˆ†é˜ Baseline â­ |
| **é–“éš”ä¼‘æ¯** | ç„¡ | è‡³å°‘3åˆ†é˜é–“éš” â­ |
| **å•å·** | 5é¡Œè©•ä¼°å•å· | 3é¡Œè©•ä¼°å•å·ï¼ˆvalence, arousal, relaxationï¼‰ |

---

## ğŸ“ æŠ€è¡“æ”¯æ´

å¦‚æœ‰å•é¡Œï¼Œè«‹æª¢æŸ¥ï¼š
1. æª”æ¡ˆçµæ§‹æ˜¯å¦æ­£ç¢º
2. éŸ³æ¨‚æª”æ¡ˆæ˜¯å¦å­˜åœ¨
3. Python ç‰ˆæœ¬ â‰¥ 3.10
4. PySide6 æ˜¯å¦å·²å®‰è£

---

**ç¥å¯¦é©—é †åˆ©ï¼** ğŸµ
